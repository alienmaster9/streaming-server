<!DOCTYPE html>
<html>
  <head>
    <title>Connection Counter</title>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js"></script>
    <script src="/socket.io/socket.io.js"></script>
    <script>
      function msgBroadcast(msg){
        var new_message = "<li>" + msg.msg + "</li>";
        $('#conversation').append(new_message);
      }

      function msgReceived(msg){
        $clientCounter.html(msg.clients);
      }

      $(document).ready(function () {
        $clientCounter = $("#client_count")

        var socket = io.connect('http://localhost:4000');
        socket.on('message', function(msg){msgReceived(msg)});
        socket.on('msg_broadcast', function(msg){msgBroadcast(msg)});

        $('#send_button').on('click', function() {
          var msg = $('#new_message').val();
          socket.emit('new_message', {msg: msg});
          console.log("Enviando mensaje " + msg);
        });
      });
    </script>
  </head>
  <body>
  <h2>Test</h2>
    <video width="320" height="250"> 
    </video>
    <canvas width="320" height="250"> 
    </canvas>
 
<span id="client_count">0</span> connected clients
<br/>
<input type="text" id="new_message">
<a href="javascript:void(0)" id="send_button">Enviar</a>
<h2>Conversacion</h2>
<ul id="conversation">
</ul>
 
    <script src="main.js"></script>
</body>
</html>
